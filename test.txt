import pyodbc
import pandas as pd
# Some other example server values are
# server = 'localhost\sqlexpress' # for a named instance
# server = 'myserver,port' # to specify an alternate port
server = 'iam-serveur.database.windows.net'
database = 'surveillance_risque_credit'
username = 'iam-admin'
password = 'NLPinBPCE!2'
cnxn = pyodbc.connect('DRIVER={ODBC Driver 18 for SQL Server};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password)
cursor = cnxn.cursor()
# select 26 rows from SQL table to insert in dataframe.
query = "SELECT an,publication_date,publication_datetime,company_codes FROM brut WEHERE publication_date>='2022-01-01' AND publication_date<'2023-06-01' ;"
df_brut = pd.read_sql(query, cnxn)
